@isTest
public class calc_EM_14832test {

    static testmethod void test(){
        
        Measure__c Measureobj=new Measure__c(Measure_Name__c='TestMeasure');
        insert Measureobj;
        
        Program__c probj=new Program__c(name='TestProgram',GL_String__c='Test',Application_Record_Type__c='Custom');
        insert Probj;
        
        Eligible_Measure__c ElMObj=new Eligible_Measure__c(Measure__c=MeasureObj.id,Program__c=probj.id);
        insert ElMObj;
        
        Qualified_Product_List_Master__c qplMaster = new Qualified_Product_List_Master__c ();
        insert qplMaster;
        
        //Name = 'qpl-101',
        Qualified_Product_List__c qpl = new Qualified_Product_List__c();
        qpl.Qualified_Product_List_Master__c = qplMaster.id;
        qpl.Units_Per_Pack__c = 2;
        qpl.SKU_Incentive__c  = 12.20;
        insert qpl;
        
        Participation_Data__c pD = new Participation_Data__c(Qualified_Product_List__c = qpl.id);
        insert pD;
        
        //insert EA
        Enrollment_Application__c EAObj=new Enrollment_Application__c(Applicant_Email_Address__c='Test@gmail.com',Program__c=probj.id, Participation_Data__c = pD.id, Enrollment_Channel__c = 'Upstream');
        insert EAobj;
        
        dsmtApproved_MLI_Stages__c appCstmSetting = new dsmtApproved_MLI_Stages__c(name='Acquired');
        insert appCstmSetting;
        
        // Insert Measure Line Item Record to fire Trigger
        Measure_Line_Item__c measureItem = new Measure_Line_Item__c(Eligible_Measure__c=ElmObj.id,Enrollment_Application__c=EAObj.id);
        measureItem.Heating_System_Fuel_Type__c = 'Natural Gas';
        measureItem.Purchase_Price__c = 500;
        measureItem.Efficient_Tank_Size_Gallons__c = 250;
        measureItem.Efficient_Energy_Factor__c = 2;
        measureItem.Package_Quantity__c = 2;
        measureItem.Start_Date__c =  Date.newInstance(2020,01,01);
        measureItem.Purchase_Date__c = Date.newInstance(2018,01,01);
        measureItem.Rated_Lumen_Output__c = 250;
        measureItem.Incentive_Per_Package__c = 12;
        measureItem.Package_Quantity__c = 2;
        measureItem.Units_Per_Package__c = 1;
        measureItem.Efficient_Lamp_Wattage__c = 0.2;
        measureItem.Sale_Date__c = Date.newInstance(2018, 12, 18);

        Insert measureItem;
        
        calc_EM_14832 c1 = new calc_EM_14832(measureItem);
        c1.populateValues();    

        measureItem.Rated_Lumen_Output__c = 2580;
        measureItem.Start_Date__c = Date.newInstance(2017,12,01);
        calc_EM_14832 c2 = new calc_EM_14832(measureItem);
        c2.populateValues();

        measureItem.Rated_Lumen_Output__c = 3000;
        measureItem.Start_Date__c = Date.newInstance(2018,02,01);
        calc_EM_14832 c3 = new calc_EM_14832(measureItem);
        c3.populateValues();  

        measureItem.Rated_Lumen_Output__c = 2601;
        measureItem.Start_Date__c = Date.newInstance(2017,12,01);
        calc_EM_14832 c4 = new calc_EM_14832(measureItem);
        c4.populateValues();

        measureItem.Rated_Lumen_Output__c = 5280;
        measureItem.Start_Date__c = Date.newInstance(2019,01,01);
        calc_EM_14832 c5 = new calc_EM_14832(measureItem);
        c5.populateValues();

        measureItem.Rated_Lumen_Output__c = 1050;
        calc_EM_14832 c6 = new calc_EM_14832(measureItem);
        c6.populateValues();

        EAobj.Enrollment_Channel__c = 'Online';
        update EAobj;


        measureItem.Rated_Lumen_Output__c = 750;
        calc_EM_14832 c7 = new calc_EM_14832(measureItem);

        c7.populateValues();
    }
    
    static testmethod void test1(){
        
        Measure__c Measureobj=new Measure__c(Measure_Name__c='TestMeasure');
        insert Measureobj;
        
        Program__c probj=new Program__c(name='TestProgram',GL_String__c='Test',Application_Record_Type__c='Custom');
        insert Probj;
        
        Eligible_Measure__c ElMObj=new Eligible_Measure__c(Measure__c=MeasureObj.id,Program__c=probj.id);
        insert ElMObj;
        
        Qualified_Product_List_Master__c qplMaster = new Qualified_Product_List_Master__c ();
        insert qplMaster;
        
        //Name = 'qpl-101',
        Qualified_Product_List__c qpl = new Qualified_Product_List__c();
        qpl.Qualified_Product_List_Master__c = qplMaster.id;
        qpl.Units_Per_Pack__c = 2;
        qpl.SKU_Incentive__c  = 12.20;
        insert qpl;
        
        Participation_Data__c pD = new Participation_Data__c(Qualified_Product_List__c = qpl.id);
        insert pD;
        
        //insert EA
        Enrollment_Application__c EAObj=new Enrollment_Application__c(Applicant_Email_Address__c='Test@gmail.com',Program__c=probj.id, Participation_Data__c = pD.id, Enrollment_Channel__c = 'Upstream');
        insert EAobj;
        
        dsmtApproved_MLI_Stages__c appCstmSetting = new dsmtApproved_MLI_Stages__c(name='Acquired');
        insert appCstmSetting;
        
        // Insert Measure Line Item Record to fire Trigger
        Measure_Line_Item__c measureItem = new Measure_Line_Item__c(Eligible_Measure__c=ElmObj.id,Enrollment_Application__c=EAObj.id);
        measureItem.Heating_System_Fuel_Type__c = 'Natural Gas';
        measureItem.Purchase_Price__c = 500;
        measureItem.Efficient_Tank_Size_Gallons__c = 250;
        measureItem.Efficient_Energy_Factor__c = 2;
        measureItem.Package_Quantity__c = 2;
        measureItem.Start_Date__c =  Date.newInstance(2020,01,01);
        measureItem.Purchase_Date__c = Date.newInstance(2018,01,01);
        measureItem.Rated_Lumen_Output__c = 250;
        measureItem.Incentive_Per_Package__c = 12;
        measureItem.Package_Quantity__c = 2;
        measureItem.Units_Per_Package__c = 1;
        measureItem.Efficient_Lamp_Wattage__c = 0.2;
        measureItem.Sale_Date__c = Date.newInstance(2020, 12, 18);

        Insert measureItem;
        
        calc_EM_14832 c1 = new calc_EM_14832(measureItem);
        c1.populateValues();    

        measureItem.Rated_Lumen_Output__c = 2580;
        measureItem.Start_Date__c = Date.newInstance(2017,12,01);
        calc_EM_14832 c2 = new calc_EM_14832(measureItem);
        c2.populateValues();

        measureItem.Rated_Lumen_Output__c = 3000;
        measureItem.Start_Date__c = Date.newInstance(2018,02,01);
        calc_EM_14832 c3 = new calc_EM_14832(measureItem);
        c3.populateValues();  

        measureItem.Rated_Lumen_Output__c = 2601;
        measureItem.Start_Date__c = Date.newInstance(2017,12,01);
        calc_EM_14832 c4 = new calc_EM_14832(measureItem);
        c4.populateValues();

        measureItem.Rated_Lumen_Output__c = 5280;
        measureItem.Start_Date__c = Date.newInstance(2019,01,01);
        calc_EM_14832 c5 = new calc_EM_14832(measureItem);
        c5.populateValues();

        measureItem.Rated_Lumen_Output__c = 1050;
        calc_EM_14832 c6 = new calc_EM_14832(measureItem);
        c6.populateValues();

        EAobj.Enrollment_Channel__c = 'Online';
        update EAobj;


        measureItem.Rated_Lumen_Output__c = 750;
        calc_EM_14832 c7 = new calc_EM_14832(measureItem);

        c7.populateValues();
    }
    
}